<%= title(t(".title")) %>

<table id="upgrade_list" cellspacing="0" cellpadding="0">
  <tr class="points">
    <td class="name"><%= Character.human_attribute_name("points") %></td>
    <td class="value" id="upgrade_points"><%= current_character.points %></td>
    <td class="" colspan="2">
      <%= raw t(".buy_more.text",
            :premia => link_to(t(".buy_more.premia"), premium_path)
          ) %>
    </td>
  </tr>
  <% Character::UPGRADABLE_ATTRIBUTES.each do |attribute| %>
    <% content_tag :tr, :class => attribute do %>
      <td class="name"><%= Character.human_attribute_name(attribute.to_s) %></td>
      <td class="value"><%= current_character.send(attribute) %></td>
      <td class="controls">
        <%= link_to_remote(button(Setting.i("character_#{attribute}_upgrade"), :disable_asset => true),
              :url    => upgrade_character_path(current_character, :attribute => attribute),
              :update => :result,
              :html   => {:class => "button upgrade"}
            ) %>
      </td>
      <td class="points"><%= t(".points", :count => Setting.i("character_#{attribute}_upgrade_points")) %></td>
    <% end %>
  <% end %>
</table>

<div id="upgrade_finished" style="display:none;" class="note">
  <%= raw t(".finished.note",
        :profile  => link_to(t(".finished.profile"), character_path(current_character)),
        :get_more => link_to(t(".finished.get_more"), premium_path)
      ) %>
</div>

<% dom_ready do %>
  $(document).bind('character.upgrade_complete', function(){
    $('#upgrade_list').hide();
    $('#upgrade_finished').show();
  })
<% end %>
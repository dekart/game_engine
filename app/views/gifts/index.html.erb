<%= title(t('.title')) %>

<% collection(@gifts) do %>
  <table id="gifts_list">
    <% @gifts.each do |gift| %>
      <% content_tag_for(:tr, gift) do %>
        <td class="sender">
          <div class="name"><%= character_name_link(gift.sender) %></div>
          <div class="picture"><%= character_picture_link(gift.sender, {}, {:size => :small}) %></div>
        </td>
        <td class="sends"><%= t(".sends") %></td>
        <td class="item">
          <div class="name"><%= gift.item.name %></div>
          
          <div class="image"><%= item_image(gift.item, :small) %></div>
        </td>
        <td class="controls">
          <%= link_to_remote(button(:accept),
                :url => gift_path(gift),
                :update => :ajax,
                :method => :put,
                :html => {
                  :'data-click-once' => true,
                  :class => 'accept button'
                }
              ) %>
        </td>
      <% end %>
    <% end %>
  </table>
<% end%>

<% if false %>
<% content_for :result do %>
  <% result_for :gift, :inline => true do |builder| %>
    <% builder.buttons do %>
      <% if Setting.b(:gifting_accept_all) %>
        <% if current_character.gifts.has_unaccepted? %>
          <%= link_to(button(:accept_all), gift_path(:all), :class => 'pending button') %>
        <% end %>
      <% else %>
        <%= link_to(button(:accept_pending), fb_app_requests_url, :class => "pending button", :target => :_top) %>
      <% end %>
    <% end %>

    <% builder.success do %>
      <%= t(".success") %>
    <% end %>

    <% @gifts.each do |gift| %>
      <table class="details" cellspacing="0" cellpadding="0">
        <tr>
          <td class="controls">
          </td>
        </tr>
      </table>
    <% end %>
  <% end %>
<% end %>
<% end%>

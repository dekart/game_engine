<div id="boss_fight_block">
  <% fights.each do |fight| %>
    <% div_for fight, :class => :clearfix do %>
      <div class="buttons">
        <%= link_to_remote(button(:attack),
              :url    => boss_fight_url(fight, :canvas => false),
              :method => :put,
              :update => :result,
              :html   => {:class => "attack button"}
            ) %>
      </div>
      
      <div class="image"><%= image_tag(fight.boss.image.url(:small)) if fight.boss.image? %></div>

      <div class="text">
        <%= raw t(".text", 
              :boss => content_tag(:span, fight.boss.name, :class => :name)
            ) %>
      </div>

      <% if fight.time_limit? %>
        <div class="timer">
          <%= raw t(".time_left", 
                :value => content_tag(:span, "", :id => dom_id(fight, :timer), :class => :value)
              ) %>
        </div>

        <% dom_ready do %>
          Timer.start('<%= dom_id(fight, :timer) %>', <%= fight.time_left %>, function(){
            <%= remote_function(
                  :url    => boss_fight_url(fight, :canvas => false),
                  :method => :put,
                  :update => :result
                ) %>
          });
        <% end %>
      <% end %>
    <% end %>
  <% end %>
</div>
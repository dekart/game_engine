<%= render_to_result :property do |builder| %>
  <% if @property.errors.empty? %>
    <% builder.success do %>
      <%= t(".messages.success",
            :property_name  => strong_tag(@property.name),
            :level          => @property.level
          ).html_safe %>
    <% end %>
    
    <table class="payouts" cellpadding="0" cellspacing="0">
      <tr>
        <td class="spent">
          <h3><%= t(".you_spent.title") %></h3>

          <%= payout(:basic_money,
                number_to_currency(@property.property_type.upgrade_price(@property.level - 1))
              ) if @property.basic_price > 0 %>
          <%= payout(:vip_money, number_to_currency(@property.vip_price)) if @property.vip_price > 0 %>
          
          <%= payout_list(@property, @result, :action => :remove) %>
        </td>
        
        <% unless @result.empty? %>
          <td class="received">
            <h3><%= t(".you_received.title") %></h3>
  
            <%= payout_list(@property, @result) %>
          </td>
        <% end %>
      </tr>
    </table>
    
  <% else %>
    <div class="unsatisfied_requirements">
      <%= unsatisfied_requirement_list(@property.upgrade_requirements) %>
    </div>
  <% end %>

  <% builder.on_ready do %>
    $('#property_list').html('<%= escape_javascript(render("list", :properties => @properties)) %>');
  <% end %>
<% end %>

<% content_for :result do %>
  <% result_for :gift, :inline => true do |builder| %>
    <% builder.buttons do %>
      <% if Setting.b(:gifting_accept_all) %>
        <% if current_character.gifts.has_unaccepted? %>
          <%= link_to(button(:accept_all), gift_path(:all), :class => 'pending button') %>
        <% end %>
      <% else %>
        <%= link_to(button(:accept_pending), fb_app_requests_url, :class => "pending button", :target => :_top) %>
      <% end %>
    <% end %>

    <% builder.success do %>
      <%= t(".success") %>
    <% end %>

    <% @gifts.each do |gift| %>
      <table class="details" cellspacing="0" cellpadding="0">
        <tr>
          <td class="sender">
            <%= character_picture_link(gift.character, {}, {:size => :small}) %><br />
            <%= character_name_link(gift.character) %>
          </td>
          <td class="sends"><%= t(".sends") %></td>
          <td class="item">
            <%= item_image(gift.item, :small) %>

            <div class="name"><%= gift.item.name %></div>
          </td>
          <td class="controls">
            <%= link_to_remote(inventory_use_button(gift.inventory),
                  :url    => use_inventory_path(gift.inventory),
                  :update => :result,
                  :html   => {:class => "use button"}
                ) if gift.inventory.usable? %>
          </td>
        </tr>
      </table>
    <% end %>
  <% end %>
<% end %>

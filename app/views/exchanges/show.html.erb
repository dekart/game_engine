<%= title(t(".title")) %>

<%= render("inventories/buttons", :current => :exchange) %>

<% if @exchange.transacted? || @exchange.invalid? %>
  <div class="note"><%= t(".invalid") %></div>
<% else %>
  <div id="show_exchange">
    <table class="exchange_info" cellpadding="0" cellspacing="0">
      <tr>
        <td class="item">
          <h2>
            <%= t('.item_name', 
                  :item => @exchange.item.name, 
                  :amount => @exchange.amount
                ) %>
          </h2>
          
          <%= item_image(@exchange.item, :medium, :tooltip => true) %>
        </td>
        <td class="text">
          <h3><%= t('.text') %></h3>
          
          <%= @exchange.text %>
        </td>
        
        <% if current_character == @exchange.character %>
          <td class="buttons">
            <%= link_to_function(button(:publish), stream_dialog(:exchange, @exchange), 
                  :class => 'button publish'
                ) %>
            
            <%= link_to(button(:delete), exchange_path(@exchange),
                  :remote   => true,
                  :method   => :delete,
                  :confirm  => t(".buttons.delete_confirm"),
                  :class => 'button delete'
                ) %>
          </td>
        <% end %>
      </tr>
    </table>
    
    <% if current_character == @exchange.character %>
      <%= render('exchange_offers/proposed_for_transactor', :exchange => @exchange) %>
    <% else %>
      <%= render('exchange_offers/proposed_by_participant', :exchange => @exchange) %>
      
      <%= render('exchange_offers/exchangeables', :exchange => @exchange) %>
    <% end %>
  </div>
<% end %>

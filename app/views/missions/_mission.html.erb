<tr class="mission" id="<%= dom_id(mission) %>">
  <td class="info">
    <div class="image">
      <% if mission.pictures? %>
        <%= image_tag(mission.pictures.url(:small)) %>
      <% else %>
        <%= asset_image_tag(:mission_placeholder) %>
      <% end %>

      <div class="progress"><%= mission_progress(rank) %></div>
    </div>

    <div class="name"><%= mission.name %></div>
    <div class="description"><%= mission.description.to_s.html_safe %></div>

    <div class="controls">
      <% if mission.repeatable? || rank.nil? || !rank.completed? %>
        <%= link_to(mission_button(mission, rank), fulfill_mission_path(mission),
              :remote => true,
              :update => :result,
              :html   => {
                :"data-click-once" => true,
                :class => "fulfill button"
              }
            ) %>

      <% else %>
        <div class="completed"><%= t('.completed') %></div>
      <% end %>
    </div>
  </td>
  <td class="details">
    <div class="payouts">
      <h3><%= Mission.human_attribute_name("payouts") %></h3>

      <%= payout(:experience, level.experience) %>
      <%= payout(:basic_money, mission_money(level)) %>

      <%= payout_list(level, level.applicable_payouts,
            :format   => :preview,
            :triggers => rank.next_payout_triggers
          ) %>
    </div>

    <div class="requirements">
      <h3><%= Mission.human_attribute_name("requirements") %></h3>

      <%= attribute_requirement(:energy, level.energy, current_character.ep >= level.energy) %>

      <%= requirement_list(level.applicable_requirements, :visible => true) %>
    </div>
  </td>
</tr>

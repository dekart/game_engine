<% dialog :item_upgrades do %>
  <h2><%= t(".title") %></h2>
  
  <% remote_form_for(@inventory, :url => item_upgrade_path(@inventory.id), :html => {:method => :put}, :update => :ajax) do |f| %>
    <div class="item">
      <div class="label"><label><%= t(".item") %></label></div>
      <div class="name"><%= @inventory.item.name %></div>
      <div class="item_image">
        <%= item_image(@inventory.item, :small, :tooltip => true) %>
      </div>
      <div class="effects"><%= item_effects(@inventory.item) %></div>
    </div>

    <div class="item">
      <div class="label"><label><%= t(".new_item") %></label></div>
      <div class="name"><%= @recipe.result.name %></div>
      <div class="item_image">
        <%= item_image(@recipe.result, :small, :tooltip => true) %>
      </div>
      <div class="effects"><%= item_effects(@inventory.item) %></div>
    </div>

	<div class="info">
      <div class="price"><%= t(".price", :amount => @recipe.price) %></div>
      <div class="tokens"><%= t(".tokens", :amount => current_character.upgrade_tokens) %></div>
    </div>

	<%= f.text_field :amount %>

    <td class="controls">
      <%= hidden_field_tag(:amount, 0, :class => :hidden_value) %>
      <div class="minus_value_attribute"></div>
      <div class="attribute_slider" data-count-points="1" data-character-upgrade="1"></div>
      <div class="plus_value_attribute"></div>
    </td>

    <%= link_to_function(button(:upgrade), "$(this).parents('form').submit()", 
          :class => 'upgrade button', :'data-click-once' => true
        ) %>
  <% end %>
<% end %>
